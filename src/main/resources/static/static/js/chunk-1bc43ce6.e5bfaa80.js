(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1bc43ce6"],{1148:function(e,t,a){"use strict";var i=a("a691"),n=a("1d80");e.exports="".repeat||function(e){var t=String(n(this)),a="",s=i(e);if(s<0||s==1/0)throw RangeError("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(t+=t))1&s&&(a+=t);return a}},"408a":function(e,t,a){var i=a("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=i(e))throw TypeError("Incorrect invocation");return+e}},"69eb":function(e,t,a){"use strict";var i=a("a4aa"),n=a.n(i);n.a},a4aa:function(e,t,a){},b680:function(e,t,a){"use strict";var i=a("23e7"),n=a("a691"),s=a("408a"),r=a("1148"),o=a("d039"),l=1..toFixed,c=Math.floor,d=function(e,t,a){return 0===t?a:t%2===1?d(e,t-1,a*e):d(e*e,t/2,a)},u=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},m=l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o((function(){l.call({})}));i({target:"Number",proto:!0,forced:m},{toFixed:function(e){var t,a,i,o,l=s(this),m=n(e),f=[0,0,0,0,0,0],p="",h="0",g=function(e,t){var a=-1,i=t;while(++a<6)i+=e*f[a],f[a]=i%1e7,i=c(i/1e7)},b=function(e){var t=6,a=0;while(--t>=0)a+=f[t],f[t]=c(a/e),a=a%e*1e7},y=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==f[e]){var a=String(f[e]);t=""===t?a:t+r.call("0",7-a.length)+a}return t};if(m<0||m>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(p="-",l=-l),l>1e-21)if(t=u(l*d(2,69,1))-69,a=t<0?l*d(2,-t,1):l/d(2,t,1),a*=4503599627370496,t=52-t,t>0){g(0,a),i=m;while(i>=7)g(1e7,0),i-=7;g(d(10,i,1),0),i=t-1;while(i>=23)b(1<<23),i-=23;b(1<<i),g(1,1),b(2),h=y()}else g(0,a),g(1<<-t,0),h=y()+r.call("0",m);return m>0?(o=h.length,h=p+(o<=m?"0."+r.call("0",m-o)+h:h.slice(0,o-m)+"."+h.slice(o-m))):h=p+h,h}})},e382:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"searchBody"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-button",{attrs:{type:"success"},on:{click:e.showAddDialog}},[e._v("开通账号")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showAssignDialog()}}},[e._v("端口分配")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.resetFLow()}}},[e._v("重置流量")]),!e.selectedRow||e.selectedRow.disabled?a("el-button",{attrs:{type:"success",title:"启用"},on:{click:function(t){return e.handleEnableUser()}}},[e._v("启用")]):e._e(),e.selectedRow&&!e.selectedRow.disabled?a("el-button",{attrs:{type:"danger",title:"停止"},on:{click:function(t){return e.handleDisableUser()}}},[e._v("禁用")]):e._e()],1)],1)],1)],1),e._m(0)],1),a("el-table",{ref:"singleTable",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.tableData,"row-key":"id","highlight-current-row":"",border:"","tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"current-change":e.handleSelect}},[a("el-table-column",{attrs:{label:"行号",type:"index",width:"50"}}),a("el-table-column",{attrs:{label:"用户名",prop:"username"}}),a("el-table-column",{attrs:{label:"用户类型"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.userTypeList,(function(i,n){return t.row.userType===i.value?a("span",{key:i+n},[e._v(" "+e._s(i.name)+" ")]):e._e()}))}}])}),a("el-table-column",{attrs:{label:"流量限制(GB)",prop:"dataLimit"}}),a("el-table-column",{attrs:{label:"已用流量",prop:"dataUsage"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getFlow(t.row.dataUsage))+" ")]}}])}),a("el-table-column",{attrs:{label:"到期时间",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("parseTime")(t.row.expireTime,"{y}-{m}-{d}")))])]}}])}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(!1===t.row.disabled?"启用":"禁用")+" ")]}}])}),a("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini",title:"编辑"},on:{click:function(a){return e.showEditDialog(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini",title:"删除"},on:{click:function(a){return e.deleteData(t.row)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","page-sizes":[10,20,50],"page-size":e.searchForm.pageSize,"current-page":e.searchForm.pageNum,layout:"total, sizes, prev, pager, next, jumper",total:e.dataTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"开通账号",visible:e.addDialog,width:"30%"},on:{"update:visible":function(t){e.addDialog=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"130px",size:"small"}},[a("el-form-item",{attrs:{label:"用户类型",prop:"userType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini"},model:{value:e.addForm.userType,callback:function(t){e.$set(e.addForm,"userType",t)},expression:"addForm.userType"}},e._l(e.userTypeList,(function(e,t){return a("el-option",{key:e+t,attrs:{label:e.name,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{size:"mini"},model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{size:"mini"},model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),a("el-form-item",{attrs:{label:"到期时间",prop:"expireTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{size:"mini",type:"date",placeholder:"请选择到期时间",align:"right"},model:{value:e.addForm.expireTime,callback:function(t){e.$set(e.addForm,"expireTime",t)},expression:"addForm.expireTime"}})],1),a("el-form-item",{attrs:{label:"手机号",prop:"userPhone"}},[a("el-input",{attrs:{size:"mini"},model:{value:e.addForm.userPhone,callback:function(t){e.$set(e.addForm,"userPhone",t)},expression:"addForm.userPhone"}})],1),a("el-form-item",{attrs:{label:"TG",prop:"telegram"}},[a("el-input",{attrs:{size:"mini"},model:{value:e.addForm.telegram,callback:function(t){e.$set(e.addForm,"telegram",t)},expression:"addForm.telegram"}})],1),a("el-form-item",{attrs:{prop:"dataLimit",rules:[{required:!0,message:"必填项"},{type:"number",message:"必须为数字值"}]}},[a("template",{slot:"label"},[a("span",{staticStyle:{position:"relative"}},[a("span",[e._v(" 流量限制(GB) "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("p",[e._v("设置为0或负数,不限制流量")])]),a("i",{staticClass:"el-icon-question table-msg"})])],1)])]),a("el-input",{attrs:{size:"mini"},model:{value:e.addForm.dataLimit,callback:function(t){e.$set(e.addForm,"dataLimit",e._n(t))},expression:"addForm.dataLimit"}})],2)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmAddForm}},[e._v("确 定")])],1)],1),a("el-drawer",{attrs:{title:"查看端口","with-header":!1,visible:e.assignDialog,direction:"rtl",size:"60%"},on:{"update:visible":function(t){e.assignDialog=t}}},[a("div",{staticClass:"drawer-body"},[a("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-plus"},on:{click:e.showFreePortDialog}},[e._v("分配端口")]),a("el-table",{attrs:{data:e.assignData}},[a("el-table-column",{attrs:{property:"serverName",label:"服务器"}}),a("el-table-column",{attrs:{property:"localPort",label:"端口"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(!1===t.row.disabled?"启用":"禁用")+" ")]}}])}),a("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"mini",title:"删除"},on:{click:function(a){return e.deleteUserPort(t.row)}}},[e._v("删除")]),t.row.disabled?a("el-button",{attrs:{type:"success",size:"mini",title:"启用中转"},on:{click:function(a){return e.enablePort(t.row)}}},[e._v("启用")]):e._e(),t.row.disabled?e._e():a("el-button",{attrs:{type:"danger",size:"mini",title:"停止中转"},on:{click:function(a){return e.disablePort(t.row)}}},[e._v("禁用")])]}}])})],1)],1)]),a("el-drawer",{attrs:{title:"选择端口","with-header":!1,visible:e.freePortDialog,direction:"rtl",size:"50%"},on:{"update:visible":function(t){e.freePortDialog=t}}},[a("div",{staticClass:"drawer-body"},[a("el-table",{attrs:{data:e.freePortData},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{property:"serverName",label:"服务器"}}),a("el-table-column",{attrs:{property:"localPort",label:"端口"}})],1),a("div",{staticClass:"demo-drawer__footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.freePortDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.selectPorts}},[e._v("确定")])],1)],1)])],1)},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticStyle:{"font-size":"12px",color:"#606266"}},[a("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"3px"}}),e._v("流量统计有延迟, 5分钟统计一次")])}],s=(a("4160"),a("b680"),a("159b"),a("c24f")),r={data:function(){return{tableData:[],assignData:[],freePortData:[],dataTotal:null,assignUserId:null,searchForm:{pageSize:10,pageNum:1},userTypeList:[{name:"管理员",value:0},{name:"普通用户",value:1}],addForm:{id:null,username:null,addType:"add",password:null,expireTime:null,dataUsage:null,userType:1,dataLimit:0},addFormRules:{host:[{required:!0,trigger:"blur",message:"必需项"}],username:[{required:!0,trigger:"blur",message:"必需项"}],expireTime:[{required:!0,trigger:"blur",message:"必需项"}]},addDialog:!1,selectedRow:null,assignDialog:!1,freePortDialog:!1,multipleSelection:[]}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;Object(s["i"])(this.searchForm).then((function(t){e.tableData=t.data.list,e.dataTotal=t.data.total}))},deleteData:function(e){var t=this;this.$confirm("确认删除?",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["a"])({id:e.id}).then((function(e){t.$notify({message:"删除成功",type:"success"}),t.getData()}))}))},confirmAddForm:function(){var e=this;this.$refs["addForm"].validate((function(t){if(t){if("add"===e.addForm.addType&&!e.addForm.password)return void e.$notify({message:"密码不能为空",type:"warning"});Object(s["o"])(e.addForm).then((function(t){e.$notify({message:"保存成功",type:"success"}),e.addDialog=!1,e.getData()}))}}))},handleSizeChange:function(e){this.searchForm.pageSize=e,this.getData()},handleCurrentChange:function(e){this.searchForm.pageNum=e,this.getData()},showAddDialog:function(){this.addDialog=!0,this.addForm.addType="add",this.addForm.id=null},showAssignDialog:function(){var e=this;this.selectedRow?(this.assignUserId=this.selectedRow.id,Object(s["j"])({userId:this.assignUserId}).then((function(t){e.assignData=t.data})),this.assignDialog=!0):this.$notify({message:"请选择用户",type:"warning"})},showEditDialog:function(e){this.addDialog=!0,this.addForm=e,this.addForm.password=null,this.addForm.addType="edit"},showFreePortDialog:function(){var e=this;Object(s["g"])({}).then((function(t){e.freePortData=t.data})),this.freePortDialog=!0},handleSelectionChange:function(e){console.log(e),this.multipleSelection=e},handleSelect:function(e){this.selectedRow=e},selectPorts:function(){var e=this;if(console.log("multipleSelection",this.multipleSelection),this.multipleSelection.length<=0)this.$notify({message:"请选择端口",type:"warning"});else{var t=[],a=this;this.multipleSelection.forEach((function(e){t.push({portId:e.id,userId:a.assignUserId,serverId:e.serverId})})),console.log(t),Object(s["p"])(t).then((function(t){e.freePortDialog=!1,Object(s["j"])({userId:e.assignUserId}).then((function(t){e.assignData=t.data}))}))}},deleteUserPort:function(e){var t=this;this.$confirm("确认删除?",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["b"])({id:e.id}).then((function(e){t.$notify({message:"删除成功",type:"success"}),Object(s["j"])({userId:t.assignUserId}).then((function(e){t.assignData=e.data}))}))}))},disablePort:function(e){var t=this;Object(s["d"])({id:e.id}).then((function(e){t.$notify({message:"禁用完成",type:"success"}),Object(s["j"])({userId:t.assignUserId}).then((function(e){t.assignData=e.data}))}))},enablePort:function(e){var t=this;Object(s["f"])({id:e.id}).then((function(e){t.$notify({message:"启用完成",type:"success"}),Object(s["j"])({userId:t.assignUserId}).then((function(e){t.assignData=e.data}))}))},handleDisableUser:function(){var e=this;this.selectedRow?Object(s["c"])({id:this.selectedRow.id}).then((function(t){e.$notify({message:"禁用完成",type:"success"}),e.getData()})):this.$notify({message:"请选择用户",type:"warning"})},handleEnableUser:function(){var e=this;this.selectedRow?Object(s["e"])({id:this.selectedRow.id}).then((function(t){e.$notify({message:"启用完成",type:"success"}),e.getData()})):this.$notify({message:"请选择用户",type:"warning"})},getFlow:function(e){var t="";if(e/1024<1024)t=(Math.round(e/1024)>0?Math.round(e/1024):0)+"KB";else if(e/1024>=1024&&e/1024/1024<1024)t=(Math.round(e/1024/1024)>0?Math.round(e/1024/1024):0)+"MB";else if(e/1024/1024>=1024){var a=e/1024/1024/1024;t=a.toFixed(3)+"GB"}else t="0KB";return t},resetFLow:function(){var e=this;this.selectedRow?this.$confirm("确认重置流量?",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["m"])({id:e.selectedRow.id}).then((function(t){e.$notify({message:"重置成功",type:"success"}),Object(s["j"])({userId:e.assignUserId}).then((function(t){e.assignData=t.data}))}))})):this.$notify({message:"请选择用户",type:"warning"})}}},o=r,l=(a("69eb"),a("2877")),c=Object(l["a"])(o,i,n,!1,null,"0c6bdb32",null);t["default"]=c.exports}}]);